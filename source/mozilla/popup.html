<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kindle to Notion Extension</title>
  <link rel="stylesheet" href="popup.css">
  <script src="onboarding-check.js"></script>
</head>
<body>
  <div class="header">
    <img src="icons/icon48.png" alt="Kindle to Notion Logo" class="logo" />
    <div>
      <h3>Kindle to Notion</h3>
      <div id="versionInfo" class="version-info"></div>
    </div>
  </div>
  <div class="tab-container">
    <div class="tab-header" role="tablist">
      <button class="tab-btn active" id="tab-action-btn" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-action">Highlights</button>
      <button class="tab-btn" id="tab-options-btn" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-options">Settings</button>
    </div>
    <div class="tab-content" id="tab-action" role="tabpanel" aria-labelledby="tab-action-btn">
      <div class="card">
        <div class="status-row">
          <span id="amazonStatus" class="status-badge" aria-label="Amazon connection status">
            Amazon: <span class="status-dot disconnected" aria-hidden="true"></span>
          </span>
          <span id="notionStatus" class="status-badge" aria-label="Notion connection status">
            Notion: <span class="status-dot disconnected" aria-hidden="true"></span>
          </span>
        </div>
        <button id="export" class="main-action" aria-label="Export highlights to Notion">
          Export to Notion
        </button>
        <button id="navigateHighlights" class="secondary-action" aria-label="Navigate to Kindle highlights page">
          Go to Highlights
        </button>
        <div id="spinner" class="spinner-container hidden" aria-live="polite" aria-atomic="true">
          <div class="spinner" aria-label="Loading"></div>
          <span class="spinner-text"></span>
        </div>
        <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true"></div>
      </div>
    </div>
    <div class="tab-content hidden" id="tab-options" role="tabpanel" aria-labelledby="tab-options-btn">
      <div class="card">
        <label for="token">
          Notion API Token: <span class="required" aria-label="required">*</span>
          <div class="input-group">
            <input
              type="text"
              id="token"
              name="token"
              placeholder="ntn_xxxxxxxxxxxxx"
              autocomplete="off"
              required
              aria-required="true"
              aria-describedby="token-help"
            >
            <button
              id="toggleToken"
              class="toggle-icon"
              type="button"
              tabindex="0"
              aria-label="Toggle token visibility"
              aria-pressed="false"
            >
              <svg class="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
              <svg class="eye-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                <line x1="1" y1="1" x2="23" y2="23"></line>
              </svg>
            </button>
          </div>
          <small id="token-help" class="help-text">
            Generate at <a href="https://www.notion.so/my-integrations" target="_blank" rel="noopener noreferrer">notion.so/my-integrations</a>
          </small>
        </label>

        <label for="databaseId">
          Notion Database ID: <span class="required" aria-label="required">*</span>
          <input
            type="text"
            id="databaseId"
            name="databaseId"
            placeholder="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
            autocomplete="off"
            required
            aria-required="true"
            aria-describedby="database-help"
          >
          <small id="database-help" class="help-text">
            Copy from your Notion database URL
          </small>
        </label>

        <label for="titleProperty">
          Book Title Property Name:
          <input
            type="text"
            id="titleProperty"
            name="titleProperty"
            placeholder="Book Title"
            autocomplete="off"
            aria-describedby="title-help"
          >
          <small id="title-help" class="help-text">
            Must match your Notion database property name
          </small>
        </label>

        <label for="authorProperty">
          Author Property Name:
          <input
            type="text"
            id="authorProperty"
            name="authorProperty"
            placeholder="Author"
            autocomplete="off"
            aria-describedby="author-help"
          >
          <small id="author-help" class="help-text">
            Must match your Notion database property name
          </small>
        </label>

        <label for="kindleRegion">
          Kindle Region:
          <select
            id="kindleRegion"
            name="kindleRegion"
            aria-describedby="region-help"
          >
            <option value="https://read.amazon.com/notebook">ðŸ‡ºðŸ‡¸ United States (amazon.com)</option>
            <option value="https://ler.amazon.com.br/notebook">ðŸ‡§ðŸ‡· Brazil (amazon.com.br)</option>
            <option value="https://read.amazon.ca/notebook">ðŸ‡¨ðŸ‡¦ Canada (amazon.ca)</option>
            <option value="https://read.amazon.co.uk/notebook">ðŸ‡¬ðŸ‡§ United Kingdom (amazon.co.uk)</option>
            <option value="https://read.amazon.de/notebook">ðŸ‡©ðŸ‡ª Germany (amazon.de)</option>
            <option value="https://read.amazon.fr/notebook">ðŸ‡«ðŸ‡· France (amazon.fr)</option>
            <option value="https://read.amazon.es/notebook">ðŸ‡ªðŸ‡¸ Spain (amazon.es)</option>
            <option value="https://read.amazon.it/notebook">ðŸ‡®ðŸ‡¹ Italy (amazon.it)</option>
            <option value="https://read.amazon.co.jp/notebook">ðŸ‡¯ðŸ‡µ Japan (amazon.co.jp)</option>
            <option value="https://read.amazon.com.au/notebook">ðŸ‡¦ðŸ‡º Australia (amazon.com.au)</option>
            <option value="https://read.amazon.in/notebook">ðŸ‡®ðŸ‡³ India (amazon.in)</option>
            <option value="https://read.amazon.com.mx/notebook">ðŸ‡²ðŸ‡½ Mexico (amazon.com.mx)</option>
          </select>
          <small id="region-help" class="help-text">
            Select your Amazon Kindle region
          </small>
        </label>

        <button id="save" class="main-action" type="button">
          Save Settings
        </button>
      </div>
    </div>
  </div>
  <script src="popup.js"></script>
</body>
</html>